<!DOCTYPE html>
<html class="light" lang="es">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <meta name="description" content="Panel de Paciente - Plataforma de Citas M√©dicas"/>
    <title>Mi Dashboard - Plataforma de Citas M√©dicas</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
    
    <!-- Custom CSS -->
    <link href="css/custom.css" rel="stylesheet"/>
    <link href="css/navigation.css" rel="stylesheet"/>
    
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#0c7e7c",
                        "background-light": "#f4f8f8",
                        "background-dark": "#112121",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        
        /* Smooth transitions for sections */
        .section {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }
        
        .section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>

<body class="bg-background-light dark:bg-background-dark font-display text-[#0e1b1b] dark:text-white">
    <div class="relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden">
        <div class="layout-container flex h-full grow flex-col">
            
            <!-- Header / Navbar (insertado din√°micamente por navigation.js) -->
            
            <!-- Main Content -->
            <main class="flex flex-1 justify-center px-4 sm:px-6 lg:px-8 py-8">
                <div class="layout-content-container flex flex-col max-w-[1200px] flex-1">
                    
                    <!-- ==============================================
                         SECCI√ìN: DASHBOARD (Principal)
                    ============================================== -->
                    <div id="dashboard-section" class="section active">
                        <!-- Welcome Section -->
                        <div class="flex flex-wrap justify-between gap-3 pb-6">
                            <div class="flex min-w-72 flex-col gap-2">
                                <h1 class="text-[#0e1b1b] dark:text-white text-4xl font-black leading-tight tracking-[-0.033em]">
                                    ¬°Bienvenido/a de nuevo!
                                </h1>
                                <p class="text-[#4d9997] dark:text-gray-400 text-base font-normal leading-normal">
                                    Gestiona tus citas y consulta tu historial m√©dico
                                </p>
                            </div>
                            <button onclick="window.location.href='book_new_appointment.html'" class="flex min-w-[120px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 px-5 bg-primary text-white gap-2 text-base font-bold leading-normal tracking-[0.015em] hover:bg-primary/90 transition-colors shadow-md">
                                <span class="material-symbols-outlined">calendar_add_on</span>
                                <span class="truncate">Nueva Cita</span>
                            </button>
                        </div>

                        <!-- NUEVO: Sistema de Puntos y Recompensas - Card 1 (Destacado) -->
                        <div class="bg-gradient-to-r from-primary to-accent p-6 rounded-xl shadow-lg mb-8">
                            <div class="flex flex-col md:flex-row items-center justify-between gap-6">
                                <div class="flex items-center gap-4 text-white">
                                    <div class="bg-white/20 rounded-full p-4">
                                        <span class="material-symbols-outlined text-4xl">stars</span>
                                    </div>
                                    <div>
                                        <p class="text-sm opacity-90">Programa de Fidelizaci√≥n</p>
                                        <h3 class="text-3xl font-black" id="patient-points-header">120 Puntos</h3>
                                        <p class="text-xs opacity-75 mt-1">Nivel: <span id="patient-level-header" class="font-bold">Plata</span></p>
                                    </div>
                                </div>
                                <div class="flex-1 max-w-md w-full">
                                    <div class="flex items-center justify-between mb-2 text-white text-xs">
                                        <span>Bronce</span>
                                        <span>Plata</span>
                                        <span>Oro</span>
                                        <span>Platino</span>
                                    </div>
                                    <div class="w-full bg-white/30 rounded-full h-3 overflow-hidden">
                                        <div id="points-progress-bar-header" class="bg-white h-full rounded-full transition-all duration-500" style="width: 0%"></div>
                                    </div>
                                    <p class="text-white text-xs mt-2 text-right"><span id="points-to-next-header">30</span> puntos para el siguiente nivel</p>
                                </div>
                                <button onclick="showRewardsModal()" class="bg-white text-primary px-6 py-3 rounded-lg font-bold hover:bg-gray-100 transition-all hover:scale-105 shadow-md whitespace-nowrap">
                                    Ver Recompensas
                                </button>
                            </div>
                        </div>

                        <!-- NUEVO: Sistema de Puntos y Recompensas -->
                        <div class="bg-gradient-to-r from-primary/10 via-primary/5 to-accent/10 dark:from-primary/20 dark:via-primary/10 dark:to-accent/20 rounded-xl border-2 border-primary/30 p-6 mb-8 shadow-lg">
                            <div class="flex flex-col md:flex-row items-center justify-between gap-6">
                                <div class="flex items-center gap-4">
                                    <div class="bg-primary/20 rounded-full p-4">
                                        <span class="material-symbols-outlined text-primary text-4xl">stars</span>
                                    </div>
                                    <div>
                                        <h3 class="text-2xl font-black text-[#0e1b1b] dark:text-white">Programa de Recompensas</h3>
                                        <p class="text-sm text-[#4d9997] dark:text-gray-400">Acumula puntos y obt√©n beneficios exclusivos</p>
                                    </div>
                                </div>
                                <div class="text-center md:text-right">
                                    <p class="text-sm font-medium text-[#4d9997] dark:text-gray-400 mb-1">Tus puntos</p>
                                    <p class="text-4xl font-black text-primary" id="user-points">120</p>
                                </div>
                            </div>
                            
                            <!-- Barra de Progreso con Niveles -->
                            <div class="mt-6">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-sm font-bold text-[#0e1b1b] dark:text-white" id="current-level">Nivel: Plata</span>
                                    <span class="text-sm font-medium text-[#4d9997] dark:text-gray-400"><span id="points-to-next">30</span> pts para el siguiente nivel</span>
                                </div>
                                <div class="relative w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 overflow-hidden">
                                    <div id="points-progress-bar" class="absolute top-0 left-0 h-full bg-gradient-to-r from-primary to-accent rounded-full transition-all duration-500" style="width: 60%"></div>
                                </div>
                                <div class="flex justify-between mt-2 text-xs">
                                    <span class="font-medium text-gray-600 dark:text-gray-400">ü•â Bronce (0)</span>
                                    <span class="font-medium text-gray-600 dark:text-gray-400">ü•à Plata (100)</span>
                                    <span class="font-medium text-gray-600 dark:text-gray-400">ü•á Oro (250)</span>
                                    <span class="font-medium text-gray-600 dark:text-gray-400">üíé Platino (500)</span>
                                </div>
                            </div>
                            
                            <!-- Beneficios por Nivel -->
                            <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-3">
                                <div class="bg-white/50 dark:bg-gray-800/50 p-3 rounded-lg text-center">
                                    <p class="text-xs font-bold text-primary">+10 pts</p>
                                    <p class="text-xs text-gray-600 dark:text-gray-400">Por cita completada</p>
                                </div>
                                <div class="bg-white/50 dark:bg-gray-800/50 p-3 rounded-lg text-center">
                                    <p class="text-xs font-bold text-primary">+5 pts</p>
                                    <p class="text-xs text-gray-600 dark:text-gray-400">Por valorar al m√©dico</p>
                                </div>
                                <div class="bg-white/50 dark:bg-gray-800/50 p-3 rounded-lg text-center">
                                    <p class="text-xs font-bold text-primary">+20 pts</p>
                                    <p class="text-xs text-gray-600 dark:text-gray-400">Por referir a un amigo</p>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Stats Cards -->
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow card-hover">
                                <div class="flex items-center gap-4">
                                    <div class="flex items-center justify-center rounded-lg bg-primary/20 size-12">
                                        <span class="material-symbols-outlined text-primary text-2xl">event_available</span>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-[#4d9997] dark:text-gray-400">Pr√≥xima cita</p>
                                        <p class="text-2xl font-bold text-[#0e1b1b] dark:text-white">Lunes, 28 Oct</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow card-hover">
                                <div class="flex items-center gap-4">
                                    <div class="flex items-center justify-center rounded-lg bg-blue-100 dark:bg-blue-900 size-12">
                                        <span class="material-symbols-outlined text-blue-600 dark:text-blue-300 text-2xl">medical_services</span>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-[#4d9997] dark:text-gray-400">Citas totales</p>
                                        <p class="text-2xl font-bold text-[#0e1b1b] dark:text-white">12</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow card-hover">
                                <div class="flex items-center gap-4">
                                    <div class="flex items-center justify-center rounded-lg bg-green-100 dark:bg-green-900 size-12">
                                        <span class="material-symbols-outlined text-green-600 dark:text-green-300 text-2xl">notifications</span>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-[#4d9997] dark:text-gray-400">Notificaciones</p>
                                        <p class="text-2xl font-bold text-[#0e1b1b] dark:text-white">3 nuevas</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Upcoming Appointments -->
                        <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm mb-8" id="appointments">
                            <div class="flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700">
                                <h2 class="text-xl font-bold text-[#0e1b1b] dark:text-white">Pr√≥ximas Citas</h2>
                                <button class="text-sm font-medium text-primary hover:underline">Ver todas</button>
                            </div>
                            
                            <div class="p-6 space-y-4">
                                <!-- Appointment Card 1 -->
                                <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 p-4 rounded-lg bg-primary/5 dark:bg-primary/10 border border-primary/20">
                                    <div class="flex items-start gap-4 flex-1">
                                        <div class="bg-primary/20 rounded-lg p-3 min-w-[60px] text-center">
                                            <p class="text-2xl font-bold text-primary">28</p>
                                            <p class="text-xs text-primary">OCT</p>
                                        </div>
                                        <div class="flex-1">
                                            <h3 class="font-bold text-[#0e1b1b] dark:text-white">Dr. Ana Torres - Cardiolog√≠a</h3>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400 mt-1">Hospital Universitario - 10:00 AM</p>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400">Consulta de seguimiento</p>
                                        </div>
                                    </div>
                                    <div class="flex gap-2">
                                        <button class="px-4 py-2 rounded-lg bg-primary text-white text-sm font-bold hover:bg-primary/90 transition-colors">
                                            Ver detalles
                                        </button>
                                        <button class="px-4 py-2 rounded-lg bg-red-500 text-white text-sm font-bold hover:bg-red-600 transition-colors">
                                            Cancelar
                                        </button>
                                    </div>
                                </div>

                                <!-- Appointment Card 2 -->
                                <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 p-4 rounded-lg bg-gray-50 dark:bg-gray-700/50 border border-gray-200 dark:border-gray-600">
                                    <div class="flex items-start gap-4 flex-1">
                                        <div class="bg-gray-200 dark:bg-gray-600 rounded-lg p-3 min-w-[60px] text-center">
                                            <p class="text-2xl font-bold text-gray-700 dark:text-gray-200">05</p>
                                            <p class="text-xs text-gray-700 dark:text-gray-200">NOV</p>
                                        </div>
                                        <div class="flex-1">
                                            <h3 class="font-bold text-[#0e1b1b] dark:text-white">Dr. Carlos Ruiz - Dermatolog√≠a</h3>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400 mt-1">Cl√≠nica Central - 15:30 PM</p>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400">Primera consulta</p>
                                        </div>
                                    </div>
                                    <div class="flex gap-2">
                                        <button class="px-4 py-2 rounded-lg bg-primary text-white text-sm font-bold hover:bg-primary/90 transition-colors">
                                            Ver detalles
                                        </button>
                                        <button class="px-4 py-2 rounded-lg bg-red-500 text-white text-sm font-bold hover:bg-red-600 transition-colors">
                                            Cancelar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- NUEVO: Mensajes con tu M√©dico -->
                        <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm mb-8">
                            <div class="flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700">
                                <div class="flex items-center gap-3">
                                    <span class="material-symbols-outlined text-primary text-2xl">chat</span>
                                    <h2 class="text-xl font-bold text-[#0e1b1b] dark:text-white">Mensajes con tu M√©dico</h2>
                                </div>
                                <span class="px-3 py-1 text-xs font-bold rounded-full bg-red-500 text-white">1 nuevo</span>
                            </div>
                            
                            <div class="p-6">
                                <div class="space-y-3">
                                    <!-- Mensaje del m√©dico -->
                                    <div class="flex items-start gap-3 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:shadow-md transition-shadow cursor-pointer" onclick="openPatientChat()">
                                        <div class="bg-primary/20 rounded-full size-10 flex items-center justify-center flex-shrink-0">
                                            <span class="material-symbols-outlined text-primary text-sm">person</span>
                                        </div>
                                        <div class="flex-1 min-w-0">
                                            <div class="flex items-center justify-between">
                                                <h4 class="font-bold text-[#0e1b1b] dark:text-white">Dr. Ana Torres</h4>
                                                <span class="text-xs text-gray-500 dark:text-gray-400">Hace 10 min</span>
                                            </div>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400 mt-1">Los resultados de tu an√°lisis est√°n listos. ¬øNecesitas consultar algo?</p>
                                        </div>
                                        <span class="w-2 h-2 bg-red-500 rounded-full flex-shrink-0"></span>
                                    </div>
                                    
                                    <button onclick="openPatientChat()" class="w-full py-3 text-center text-primary font-bold hover:bg-primary/10 rounded-lg transition-colors">
                                        Ver todas las conversaciones ‚Üí
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Medical History Summary -->
                        <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm">
                            <div class="flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700">
                                <h2 class="text-xl font-bold text-[#0e1b1b] dark:text-white">Historial Reciente</h2>
                                <button class="text-sm font-medium text-primary hover:underline">Ver completo</button>
                            </div>
                            
                            <div class="p-6">
                                <div class="space-y-4">
                                    <!-- History Item 1 -->
                                    <div class="flex items-start gap-4 p-4 rounded-lg bg-gray-50 dark:bg-gray-700/50">
                                        <span class="material-symbols-outlined text-primary text-2xl">description</span>
                                        <div class="flex-1">
                                            <h3 class="font-bold text-[#0e1b1b] dark:text-white">Consulta Cardiolog√≠a</h3>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400 mt-1">Dr. Ana Torres - 15 Sep 2024</p>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400">Resultado: Normal. Pr√≥ximo control en 3 meses.</p>
                                        </div>
                                        <button class="text-primary hover:text-primary/80 transition-colors">
                                            <span class="material-symbols-outlined">download</span>
                                        </button>
                                    </div>

                                    <!-- History Item 2 -->
                                    <div class="flex items-start gap-4 p-4 rounded-lg bg-gray-50 dark:bg-gray-700/50">
                                        <span class="material-symbols-outlined text-primary text-2xl">biotech</span>
                                        <div class="flex-1">
                                            <h3 class="font-bold text-[#0e1b1b] dark:text-white">An√°lisis de Sangre</h3>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400 mt-1">Laboratorio Central - 08 Sep 2024</p>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400">Todos los valores dentro de rangos normales.</p>
                                        </div>
                                        <button class="text-primary hover:text-primary/80 transition-colors">
                                            <span class="material-symbols-outlined">download</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ==============================================
                         SECCI√ìN: MI PERFIL
                    ============================================== -->
                    <div id="profile-section" class="section">
                        <div class="mb-6">
                            <h1 class="text-4xl font-black leading-tight tracking-[-0.033em] text-[#0e1b1b] dark:text-white mb-2">
                                Mi Perfil
                            </h1>
                            <p class="text-base text-[#4d9997] dark:text-gray-400">
                                Administra tu informaci√≥n personal y datos m√©dicos
                            </p>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <!-- Profile Picture Section -->
                            <div class="lg:col-span-1">
                                <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow-sm">
                                    <div class="flex flex-col items-center text-center">
                                        <div class="user-avatar bg-center bg-no-repeat aspect-square bg-cover rounded-full size-32 mb-4" style='background-image: url("https://ui-avatars.com/api/?name=Usuario+Ejemplo&background=0c7e7c&color=fff&size=128")'></div>
                                        <h3 class="user-name-display text-xl font-bold text-[#0e1b1b] dark:text-white">Usuario Ejemplo</h3>
                                        <p class="user-role-display text-sm text-[#4d9997] dark:text-gray-400 mt-1">Paciente</p>
                                        <button class="mt-4 px-4 py-2 rounded-lg bg-primary text-white text-sm font-bold hover:bg-primary/90 transition-colors">
                                            Cambiar foto
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Personal Information -->
                            <div class="lg:col-span-2">
                                <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow-sm">
                                    <h2 class="text-xl font-bold text-[#0e1b1b] dark:text-white mb-6">Informaci√≥n Personal</h2>
                                    
                                    <form id="profile-form" class="space-y-4">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium mb-2">Nombre completo</label>
                                                <input 
                                                    type="text" 
                                                    id="profile-name"
                                                    class="form-input w-full rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-primary focus:border-primary"
                                                    readonly
                                                />
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium mb-2">Email</label>
                                                <input 
                                                    type="email" 
                                                    id="profile-email"
                                                    class="form-input w-full rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-primary focus:border-primary"
                                                    readonly
                                                />
                                            </div>
                                        </div>

                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium mb-2">Tel√©fono</label>
                                                <input 
                                                    type="tel" 
                                                    value="+34 600 123 456"
                                                    class="form-input w-full rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-primary focus:border-primary"
                                                />
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium mb-2">Fecha de nacimiento</label>
                                                <input 
                                                    type="date" 
                                                    value="1990-05-15"
                                                    class="form-input w-full rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-primary focus:border-primary"
                                                />
                                            </div>
                                        </div>

                                        <div>
                                            <label class="block text-sm font-medium mb-2">Direcci√≥n</label>
                                            <input 
                                                type="text" 
                                                value="Calle Ejemplo 123, Madrid"
                                                class="form-input w-full rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-primary focus:border-primary"
                                            />
                                        </div>

                                        <div class="pt-4">
                                            <button type="submit" class="px-6 py-2 rounded-lg bg-primary text-white font-bold hover:bg-primary/90 transition-colors">
                                                Guardar cambios
                                            </button>
                                        </div>
                                    </form>
                                </div>

                                <!-- Medical Information -->
                                <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow-sm mt-6">
                                    <h2 class="text-xl font-bold text-[#0e1b1b] dark:text-white mb-6">Informaci√≥n M√©dica</h2>
                                    
                                    <form class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium mb-2">Alergias conocidas</label>
                                            <textarea 
                                                rows="3"
                                                placeholder="Ej: Penicilina, Polen..."
                                                class="form-textarea w-full rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-primary focus:border-primary"
                                            ></textarea>
                                        </div>

                                        <div>
                                            <label class="block text-sm font-medium mb-2">Condiciones m√©dicas</label>
                                            <textarea 
                                                rows="3"
                                                placeholder="Ej: Hipertensi√≥n, Diabetes..."
                                                class="form-textarea w-full rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-primary focus:border-primary"
                                            ></textarea>
                                        </div>

                                        <div>
                                            <label class="block text-sm font-medium mb-2">Medicaci√≥n actual</label>
                                            <textarea 
                                                rows="3"
                                                placeholder="Ej: Ibuprofeno 600mg cada 8h..."
                                                class="form-textarea w-full rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-primary focus:border-primary"
                                            ></textarea>
                                        </div>

                                        <div class="pt-4">
                                            <button type="submit" class="px-6 py-2 rounded-lg bg-primary text-white font-bold hover:bg-primary/90 transition-colors">
                                                Guardar informaci√≥n m√©dica
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ==============================================
                         SECCI√ìN: AJUSTES
                    ============================================== -->
                    <div id="settings-section" class="section">
                        <div class="mb-6">
                            <h1 class="text-4xl font-black leading-tight tracking-[-0.033em] text-[#0e1b1b] dark:text-white mb-2">
                                Ajustes
                            </h1>
                            <p class="text-base text-[#4d9997] dark:text-gray-400">
                                Personaliza tu experiencia en la plataforma
                            </p>
                        </div>

                        <div class="space-y-6">
                            <!-- Security Settings -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow-sm">
                                <h2 class="text-xl font-bold text-[#0e1b1b] dark:text-white mb-6">Seguridad</h2>
                                
                                <form class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Contrase√±a actual</label>
                                        <input 
                                            type="password" 
                                            placeholder="Introduce tu contrase√±a actual"
                                            class="form-input w-full rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-primary focus:border-primary"
                                        />
                                    </div>

                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium mb-2">Nueva contrase√±a</label>
                                            <input 
                                                type="password" 
                                                placeholder="Nueva contrase√±a"
                                                class="form-input w-full rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-primary focus:border-primary"
                                            />
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium mb-2">Confirmar nueva contrase√±a</label>
                                            <input 
                                                type="password" 
                                                placeholder="Confirmar contrase√±a"
                                                class="form-input w-full rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-primary focus:border-primary"
                                            />
                                        </div>
                                    </div>

                                    <div class="pt-4">
                                        <button type="submit" class="px-6 py-2 rounded-lg bg-primary text-white font-bold hover:bg-primary/90 transition-colors">
                                            Cambiar contrase√±a
                                        </button>
                                    </div>
                                </form>
                            </div>

                            <!-- Notification Preferences -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow-sm">
                                <h2 class="text-xl font-bold text-[#0e1b1b] dark:text-white mb-6">Preferencias de Notificaciones</h2>
                                
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium text-[#0e1b1b] dark:text-white">Notificaciones por email</p>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400">Recibir notificaciones de citas por correo</p>
                                        </div>
                                        <input type="checkbox" checked class="h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"/>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium text-[#0e1b1b] dark:text-white">Recordatorios de citas</p>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400">Recordatorio 24h antes de la cita</p>
                                        </div>
                                        <input type="checkbox" checked class="h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"/>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium text-[#0e1b1b] dark:text-white">Ofertas y promociones</p>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400">Recibir ofertas especiales y descuentos</p>
                                        </div>
                                        <input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"/>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium text-[#0e1b1b] dark:text-white">Bolet√≠n informativo</p>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400">Newsletter mensual con consejos de salud</p>
                                        </div>
                                        <input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"/>
                                    </div>

                                    <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
                                        <button class="px-6 py-2 rounded-lg bg-primary text-white font-bold hover:bg-primary/90 transition-colors">
                                            Guardar preferencias
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Appearance Settings -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow-sm">
                                <h2 class="text-xl font-bold text-[#0e1b1b] dark:text-white mb-6">Apariencia</h2>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Modo de visualizaci√≥n</label>
                                        <select class="form-select w-full md:w-auto rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-primary focus:border-primary">
                                            <option>Claro</option>
                                            <option>Oscuro</option>
                                            <option selected>Autom√°tico (seg√∫n sistema)</option>
                                        </select>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium mb-2">Idioma</label>
                                        <select class="form-select w-full md:w-auto rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-primary focus:border-primary">
                                            <option selected>Espa√±ol</option>
                                            <option>English</option>
                                            <option>Fran√ßais</option>
                                            <option>Deutsch</option>
                                        </select>
                                    </div>

                                    <div class="pt-4">
                                        <button class="px-6 py-2 rounded-lg bg-primary text-white font-bold hover:bg-primary/90 transition-colors">
                                            Guardar cambios
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Danger Zone -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl border border-red-200 dark:border-red-900 p-6 shadow-sm">
                                <h2 class="text-xl font-bold text-red-600 dark:text-red-400 mb-6">Zona de Peligro</h2>
                                
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium text-[#0e1b1b] dark:text-white">Eliminar cuenta</p>
                                            <p class="text-sm text-[#4d9997] dark:text-gray-400">Esta acci√≥n es permanente y no se puede deshacer</p>
                                        </div>
                                        <button class="px-4 py-2 rounded-lg bg-red-500 text-white font-bold hover:bg-red-600 transition-colors">
                                            Eliminar cuenta
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </main>
            
            <!-- Footer (insertado din√°micamente por navigation.js) -->
            
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/common.js"></script>
    <script src="js/api.js"></script>
    <script src="js/navigation.js"></script>
    <script src="js/navigation-config.js"></script>
    <script src="js/navigation-enhanced.js"></script>
    
    <script>
        // üîí PROTECCI√ìN: Solo pacientes pueden acceder
        if (!protectPage('paciente')) {
            // Si falla la validaci√≥n, protectPage() redirige autom√°ticamente
        }
        
        // üë§ PERSONALIZACI√ìN: Mostrar nombre del usuario
        document.addEventListener('DOMContentLoaded', function() {
            const user = authAPI.getCurrentUser();
            if (user && user.name) {
                // Actualizar mensaje de bienvenida
                const welcomeTitle = document.querySelector('h1');
                if (welcomeTitle && welcomeTitle.textContent.includes('Bienvenido')) {
                    welcomeTitle.textContent = `¬°Bienvenido/a de nuevo, ${user.name.split(' ')[0]}!`;
                }
            }
        });
    </script>
    
    <!-- üÜï M√ìDULO PRINCIPAL: Patient Dashboard con conexi√≥n al backend -->
    <script type="module" src="js/modules/patient-dashboard.js"></script>
    
    <!-- üÜï M√ìDULO DE ACCESIBILIDAD: WCAG 2.1 AA -->
    <script type="module" src="js/modules/accessibility.js"></script>
</body>
</html>
